!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-helmet")},function(e,t){e.exports=require("react-router")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("koa2")},function(e,t){e.exports=require("koa-static")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports={wdsPort:9002,nodeServerPort:9001}},function(e){e.exports=JSON.parse('{"libs.js":"/js/libs.4d4b2bb4.js","main.css":"/css/main.acb57427.css","main.js":"/js/main.5f5f98d3.js"}')},function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),s=n(5),i=n.n(s),o=n(0),c=n.n(o),l=n(6),u=n(2),p=n(1),d=n(3);class m extends c.a.Component{constructor(e){super(e)}render(){return c.a.createElement("div",{className:"layout-box"},c.a.createElement("h1",null,"koa+react+ssr"),c.a.createElement(d.NavLink,{to:"/index",style:{marginLeft:"10px"}},"首页"),c.a.createElement(d.NavLink,{style:{marginLeft:"10px"},to:"/list"},"列表页"),this.props.children)}}var f=m;class h extends c.a.Component{constructor(e){super(e);const t=e.initialData||{};this.state={page:t.page}}static async getInitialProps(){return{page:{tdk:{title:"首页 - react ssr",keywords:"前端技术江湖",description:"关键词"}}}}componentDidMount(){this.state.page||h.getInitialProps().then(e=>{this.setState({page:e.page})})}handleClick(){alert("一起来玩 react ssr 呀,点我有反应吗？")}render(){const{tdk:e={}}=this.state.page||{};return c.a.createElement("div",{className:"page-index-box"},c.a.createElement(p.Helmet,null,c.a.createElement("title",null,e.title),c.a.createElement("meta",{name:"description",content:e.description}),c.a.createElement("meta",{name:"keywords",content:e.keywords})),c.a.createElement("span",{onClick:this.handleClick},"首页"))}}var g=h;const y=[{title:"深入浅出TypeScript：从基础知识到类型编程",desc:"Vue3 源码及开发必备基础，从基础知识到类型工具设计，从理论到实战，手把手让你从零基础成为进阶使用者。",img:"https://user-gold-cdn.xitu.io/2019/11/8/16e4ab5d6aff406a?imageView2/1/w/200/h/280/q/95/format/webp/interlace/1"},{title:"SVG 动画开发实战手册",desc:"从0到1，学习SVG动画开发知识，快速高效完成SVG动画效果开发。",img:"https://user-gold-cdn.xitu.io/2019/9/26/16d6bda264ac27e4?imageView2/1/w/200/h/280/q/95/format/webp/interlace/1"},{title:"预售JavaScript 设计模式核⼼原理与应⽤实践",desc:"通俗易懂的编程“套路“学。带你深入看似高深实则接地气的设计模式原理，在实际场景中内化设计模式的”道“与”术“。学会驾驭代码，而非被其奴役。",img:"https://user-gold-cdn.xitu.io/2019/9/16/16d382e623923d91?imageView2/1/w/200/h/280/q/95/format/webp/interlace/1"}];class x extends c.a.Component{constructor(e){super(e);const t=e.initialData||{};this.state={page:t.page,fetchData:t.fetchData}}static async getInitialProps(){return{fetchData:await new Promise((e,t)=>{setTimeout(()=>{e({code:0,data:y})},500)}),page:{tdk:{title:"列表页",keywords:"React 服务端渲染",description:"React 双端同构"}}}}componentDidMount(){console.log("this.state: ",this.state),this.state.fetchData||x.getInitialProps().then(e=>{this.setState({fetchData:e.fetchData,page:e.page})})}render(){const{code:e,data:t}=this.state.fetchData||{},{tdk:n={}}=this.state.page||{};return c.a.createElement("div",null,c.a.createElement(p.Helmet,null,c.a.createElement("title",null,n.title),c.a.createElement("meta",{name:"description",content:n.description}),c.a.createElement("meta",{name:"keywords",content:n.keywords})),t&&t.map((e,t)=>c.a.createElement("div",{key:t},c.a.createElement("h3",null,e.title),c.a.createElement("p",null,e.desc))),!t&&c.a.createElement("div",null,"暂无数据"))}}var b=[{path:"/",component:g,exact:!0},{path:"/index",component:g,exact:!0},{path:"/list",component:x,exact:!0}];const v=function(){let e=["libs.js","main.js"],t=["main.css"];const a={js:[],css:[]};{const r=n(8);e.forEach(e=>{r[e]&&a.js.push(`<script type="text/javascript"  src="${r[e]}"><\/script>`)}),t.forEach(e=>{r[e]&&a.css.push(`<link rel="stylesheet" type="text/css" href="${r[e]}" />`)})}return a}();var E=n(7);const j=n.n(E).a.nodeServerPort||Object({NODE_ENV:"production"}).PORT,k=new r.a;k.use(i()("./dist/static")),k.use(async(e,t)=>{const n=e.request.path;if(n.indexOf(".")>-1)return e.body=null,t();console.log("ctx.request.path.",e.request.path);let a=((e,t)=>{let n;for(let a of t)if(Object(u.matchPath)(e,a)){n=a;break}return n})(n,b),r=a.component.getInitialProps,s={};r&&(s=await r());let{page:i}=s||{},o={title:"默认标题 - my react ssr",keywords:"默认关键词",description:"默认描述"};i&&i.tdk&&(o=i.tdk);const d=Object(l.renderToString)(c.a.createElement(u.StaticRouter,null,c.a.createElement(f,null,c.a.createElement(a.component,{initialData:s})))),m=p.Helmet.renderStatic();e.body=`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <meta charset="UTF-8"/>\n      ${m.title.toString()}\n      ${m.meta.toString()}\n      ${v.css.join("")}\n    </head>\n    <body>\n      <div id="root">${d}</div>\n      <textarea id="ssrTextInitData" style="display:none;">\n        ${JSON.stringify(s)}\n      </textarea>\n      ${v.js.join("")}\n    </body>\n    </html>\n  `,await t()}),k.listen(j),console.log("server is start .","http://localhost:"+j)}]);